
const s52 = [ // default public seed for pseudo random noise generator
    1255351203262475,3141450849357664,961963562434071,1703109094960768,
    3182952956683860,1297411166427489,2451649721381461,4387033266489310,
    3782922714836573,120152331936654,3828276703790012,3051639464787366,
    822243224117123,1844198246701837,181946785711258,1567064576891215,
    1852474814179365,2946552429831395,753668456249460,3825316021364754,
    1382314683054847,770862198711849,217349187897231,2697635536015778,
    2227394692919643,130559423811858,2539889529907367,4309810912623918,
    109970160584372,3940854797949039,2280189228481254,18856182658776,
    1102485217644518,1885749592002392,973138327856568,3169002914868336,
    1022341654899198,1811423883246604,4373096854179120,2439025534758455,
    3668634703962147,2212332369185472,11879170478557,1685904659254652,
    2039455113446813,2718505838835694,2034555323779730,1035973399435630,
    964018561955736,774425083727264,4214998740642247,1610376294887341,
    615750987565181,3909831485733923,357602687814691,1483478277810770,
    3184374092678242,2994506117729880,3466375146759023,207986150465736,
    3215629381411164,2561900304366360,2121233009189296,747339214617020,
    4376663559038491,686876808085251,1825519326782826,4498126630026558,
    380813572712802,1734957694282063,2883788054658948,4127093759501583,
    4453378952926466,2810005187254841,1135956107310186,2612525685617032,
    3686732292706078,1343446999219078,3231711723777303,1714172774827029,
    745884951556156,818613463533168,13453456946600,212079651369972,
    4126988923785148,159283659572708,4114603924466489,1948468583458707,
    351196566687605,3214828008200167,1620600131600056,1048873865284368,
    728808871005472,1887747366689303,4250079895921984,4284866827467330,
    1677748102444870,2618865016263693,3288138615972921,2712795674062809,
    4271919868218508,3328419177317669,2309457494420553,2144865478755380,
    2295794489464085,2388679072255650,1429152692396164,1436459075341382,
    3321241696614352,3991023767651678,2046957879659520,1586647784674641,
    4331738038410539,681775883441312,4248015857537938,3425117814223251,
    320311216046079,4122590517533579,4052787038495680,2624217822815400,
    4172251285673589,1210509279480713,4414569424528416,1074899592731039,
    4482831969878021,3054180466592718,1292603748680290,3842644556974750
] as number[];


// deterministic, seeded pseudo random noise generator:
// Idea: use something like LCG to extend the sequence beyond 128
export class Grain {
    
    public static init(seed: number) {
        if (Grain.seeded.length === 0) {
            Grain.seeded = Grain.applySeed(Grain.seeded, seed);
        }  
    }

    public static noise() {
        if (Grain.index === 128) {
            Grain.index = 0;
        }

        return Grain.seeded[Grain.index++];
    }

    private static index = 0;
    private static publicSeed = s52;
    private static seeded = Grain.applySeed(this.publicSeed, 0);

    private static applySeed(publicSeed: number[], privateSeed: number) { 
        return publicSeed.map( v => v ^ privateSeed  ) // xor with dynamic / private seed
                         .map( v => v / 2**55 )        // normalize to [0,1]
    }

    
}